{% extends "base.html" %}
{% block title %}Editar Resultado #{{ result.id }}{% endblock %}
{% block content %}

<div class="container mt-4">
  <h2 class="fw-bold text-primary mb-4">Editar Resultado</h2>

  <form method="POST">
    <div class="row g-3">

       <!-- Estado -->
        <div class="col-md-6">
            <label class="form-label" for="estado_prueba">Estado</label>
            <select id="estado_prueba" class="form-select" name="estado_prueba" required>
            {% for estado in ['pasado', 'fallido', 'bloqueado', 'en_progreso'] %}
                <option value="{{ estado }}" {% if result.estado_prueba.value == estado %}selected{% endif %}>
                {{ estado|replace('_', ' ')|title }}
                </option>
            {% endfor %}
            </select>
        </div>

        <!-- Entorno -->
        <div class="col-md-6">
            <label class="form-label" for="entorno">Entorno</label>
            <input type="text" id="entorno" class="form-control" name="entorno" value="{{ result.entorno or '' }}">
        </div>

        <!-- URL -->
        <div class="col-md-6">
            <label class="form-label" for="url">URL</label>
            <input type="text" id="url" class="form-control" name="url" value="{{ result.url or '' }}">
        </div>

        <!-- Usuario -->
        <div class="col-md-6">
            <label class="form-label" for="usu_created">Usuario</label>
            <input type="text" id="usu_created" class="form-control" name="usu_created"
                value="{{ result.usu_created or (current_user.nombre if current_user else '') }}">
        </div>

        <!-- Resultado esperado -->
        <div class="col-12">
            <label class="form-label" for="resultado_esperado">Resultado esperado</label>
            <textarea id="resultado_esperado" class="form-control" name="resultado_esperado" rows="2">
            {{ result.resultado_esperado or '' }}
            </textarea>
        </div>

        <!-- Resultado obtenido -->
        <div class="col-12">
            <label class="form-label" for="resultado_obtenido">Resultado obtenido</label>
            <textarea id="resultado_obtenido" class="form-control" name="resultado_obtenido" rows="2">
            {{ result.resultado_obtenido or '' }}
            </textarea>
        </div>

        <!-- Pasos para reproducir -->
        <div class="col-12">
            <label class="form-label" for="pasos_repro">Pasos para reproducir</label>
            <textarea id="pasos_repro" class="form-control" name="pasos_repro" rows="2">
            {{ result.pasos_repro or '' }}
            </textarea>
        </div>

        <!-- Notas -->
        <div class="col-12">
            <label class="form-label" for="notas">Notas / Observaciones</label>
            <textarea id="notas" class="form-control" name="notas" rows="2">
            {{ result.notas or '' }}
            </textarea>
        </div>
    </div>

    <div class="mt-4 d-flex justify-content-end gap-2">
      <!-- Botón Eliminar -->
      <button type="submit" name="delete" value="1"
              class="btn btn-danger"
              onclick="return confirm('¿Seguro que deseas eliminar este resultado?');">
        Eliminar
      </button>

      <!-- Cancelar -->
      <a href="{{ url_for('test_bp.show', id=result.test_case_id) }}" class="btn btn-secondary">
        Cancelar
      </a>

      <!-- Guardar -->
      <button type="submit" class="btn btn-primary">Guardar Cambios</button>
    </div>
  </form>
</div>

{% endblock %}
